---
layout: post
title: population_simulation_1_logistics
date: 2024-01-21
tags: [algorithms]
author: taot
---

## Logistics人口模型

以 Logistics 模型为基础的人口模型优化。

### 1 Logistics 增长模型

#### 1.1 模型建立

传统的马尔萨斯人口增长模型将人口增长率 r 定为常数，从而人口数量 x 呈指数增长。但是现实中，人口增长受到自然资源和环境资源等的限制，存在一个上限，即最大人口容量 $x_{max}$。

从而，人口增长率 r 应该与人口数量 x 相关：
$$
\begin{cases}
    \frac{dx}{dt}=r(x)x \\
    x(0)=x_0
\end{cases}
\tag{1}
$$

其中，收到人口容量的影响，r(x) 应该为减函数，假设：
$$
r(x)=r_0-\alpha x \tag{2}
$$

$r_0$ 为固有增长率。

当人口达到最大容量 $x_{max}$ 时，$r(x_{max})=0$，可以得到 $\alpha = \frac{r_0}{x_{max}}$，从而方程 (1) 可以写成：
$$
\begin{cases}
    \frac{dx}{dt}=(r_0-\frac{r_0x}{x_{max}}) \\
    x(0)=x_0
\end{cases}
\tag{3}
$$

求解微分方程 (3)：
$$
x(t)=\frac{x_{max}}{1+(\frac{x_{max}}{x_0}-1)e^{-r_0t}}
\tag{4}
$$

#### 1.2 参数估计与模型拟合

通过方程 (2) 和 $\alpha =\frac{r_0}{x_{max}}$，可以得到：
$$
r(x)=r_0-\frac{r_0}{x_{max}}x \tag{5}
$$

使用中国 1961-2023 年人口数据对方程 (5) 进行拟合，得到参数：
$$
x_{max} = \\
r_0 = 
$$
将以上参数代入方程 (4)，得到预测人口数据 x(t) 与实际人口数据 x 之间的比较结果：


利用 2-范数对模型你和误差做估计：
$$
Err=||x(t)-x||_2=
$$


### 2 改进的 Logistics 增长模型

#### 2.1 模型优化

人口增长率 r 不仅与人口数量 x 有关，同时也与时间 t 相关：
$$
r(x, t)=\phi(x)T(t)
$$

将上式带入方程 (1)，得到优化的 Logistics 模型：
$$
\begin{cases}
    \frac{dx}{dt}=\phi (x) T(t)x \\
    x(0)=x_0
\end{cases}
\tag{6}
$$

#### 2.2 $\phi (x)$ 拟合分析

从最开始的 Logistics 模型分析，设 $\phi (x)$ 为人口数量的一次函数：
$$
\phi (x)=r_0-\alpha x
$$

其中，$r_0$ 为固有增长率。

当人口达到最大容量 $x_{max}$ 时，$\phi (x_{max})=0$，可以得到 $\alpha = \frac{r_0}{x_{max}}$，从而方程 (6) 可以写成：
$$
\begin{cases}
    \frac{dx}{dt}=(r_0-\frac{r_0}{r_{max}}x)T(t)x \\
    x(0)=x_0
\end{cases}
\tag{7}
$$
求解微分方程 (7)；
$$
x(t)=\frac{x_{max}}{(\frac{x_{max}}{x_0}-1)e^{-\int_0 ^t r_0T(\tau)d\tau+1}}
\tag{8}
$$

#### 2.3 $T(t)$ 拟合分析

对方程 (8) 做整形：
$$
\int _0 ^t r_0 T(\tau)d\tau = ln\frac{x(t)(x_{max}-x_0)}{x_0(x_{max} - x(t))}
\tag{9}
$$

假设 $T(\tau)$ 为关于 t 的 n 次多项式：
$$
T(t) = a_1t^n + a_2t^{t-1} + ... + a_nt + a_{n+1}
$$
将上式带入方程 (8)，得到：
$$
k_1t^{n+1}+k_2t^n+...+k_{n+1}t=ln \frac{x(t)(x_m-x_0)}{x_0(x_m-x(t))}
\tag{10}
$$
其中，$k_1=\frac{r_0a_1}{n+1}，k_2=\frac{r_0a_2}{n}，...，k_n=\frac{r_0a_n}{2}，k_{n+1}=r_0a_{n+1}$

通过 1961-2023 年中国人口总数的数据对方程 (10) 进行拟合，得到系数：
$$
k_1, k_2, ..., k_{n+1}
$$

* 当 $T(t)$ 为关于 t 的二次多项式时，拟合后的误差为：
$$
Err=||x(t)-x||_2=
\tag{11}
$$

* 当 $T(t)$ 为关于 t 的三次多项式时，拟合后的误差为：
$$
Err=||x(t)-x||_2=
\tag{12}
$$

* 当 $T(t)$ 为关于 t 的四次多项式时，拟合后的误差为：
$$
Err=||x(t)-x||_2=
\tag{13}
$$

在 $T(t)$ 为关于 t 的三次多项式时，拟合度最高。

选择 $T(t)$ 为关于 t 的三次多项式，使用 1961-2023 年中国人口总数的数据对方程 (10) 进行拟合得到参数：
$
x_m=
$
$
k_1=
$
$
k_2=
$
$
k_3=
$
$
k_4=
$

#### 2.3 模型拟合

由前面得到的参数拟合得到图像：


### 3 总结

|人口模型|最大人口容量（万人）|误差（2-范数）|预测达到最大人口的时间|
|---|---|---|---|
|Logistics 模型||||
|改进的 Logistics 模型||||

改进的 Logistics 模型在 Logistics 模型的基础上，在考虑人口增长率的时候，加入了时间变量 t，即人口增长率为关于人口数 x 和时间 t 的函数。

改进的 Logistics 模型对人口数据的拟合误差更小，具有更高的拟合精度。

这里使用的 Logistics 模型和改进的 Logistics 模型都是比较粗糙的，没有考虑人口出生率、人口死亡率以及国家宏观调控、科技进步、国民生育率和生育期望的变化等诸多因素的影响，只是对人口数据的简单拟合。

对人口变化更加精确的模拟和预测需要考虑这些诸多因素，Logistics 模型还不具备这样的效果。
